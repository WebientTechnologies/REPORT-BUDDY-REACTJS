<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Audio Visualizer</title>
    <style>
        body {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
        }

        #visualizer {
            width: 400px;
            height: 200px;
            background-color: #fff;
            display: flex;
            align-items: flex-end;
            overflow: hidden;
        }

        .bar {
            width: 10px;
            margin: 0 2px;
            background-color: #3498db;
            transition: height 0.1s;
        }
    </style>
</head>
<body>
    <div id="visualizer"></div>

    <script>
        window.addEventListener('DOMContentLoaded', () => {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const analyser = audioContext.createAnalyser();
            const visualizer = document.getElementById('visualizer');

            navigator.mediaDevices.getUserMedia({ audio: true })
                .then((stream) => {
                    const source = audioContext.createMediaStreamSource(stream);
                    source.connect(analyser);
                    analyser.connect(audioContext.destination);
                    analyser.fftSize = 256;

                    const bufferLength = analyser.frequencyBinCount;
                    const dataArray = new Uint8Array(bufferLength);

                    const barWidth = visualizer.offsetWidth / bufferLength;

                    function draw() {
                        analyser.getByteFrequencyData(dataArray);

                        visualizer.innerHTML = '';

                        for (let i = 0; i < bufferLength; i++) {
                            const barHeight = dataArray[i] / 2;
                            const bar = document.createElement('div');
                            bar.className = 'bar';
                            bar.style.height = `${barHeight}px`;
                            bar.style.width = `${barWidth}px`;
                            visualizer.appendChild(bar);
                        }

                        requestAnimationFrame(draw);
                    }

                    draw();
                })
                .catch((err) => console.error('Error accessing microphone:', err));
        });
    </script>
</body>
</html>
